{#
  Property Card Book Component - Property-specific Card
  
  This component extends the base card component for property display.
  Demonstrates how to compose the card-book with property-specific data.
  
  Usage:
  {% include 'component-books/property-card-book.twig' with {
    property: {
      title: '123 Ocean View Drive',
      image: '/path/to/property.jpg',
      address: '123 Ocean View Drive, Unit 4B',
      status: 'available',
      listing_status: 'for_sale',
      price: '$450,000',
      bedrooms: 3,
      bathrooms: 2,
      area: '1,200 sq ft',
      owner: 'John Doe'
    },
    show_owner: true,
    show_actions: true
  } %}
#}

{# Property status to badge variant mapping #}
{% set status_variants = {
  available: 'success',
  occupied: 'neutral',
  maintenance: 'warning',
  reserved: 'info'
} %}

{# Listing status to badge mapping #}
{% set listing_badges = {
  for_sale: {content: 'For Sale', variant: 'primary'},
  for_rent: {content: 'For Rent', variant: 'info'},
  not_listed: null
} %}

{# Build badges array #}
{% set badges = [] %}
{% if property.status %}
  {% set badges = badges|merge([{
    content: property.status|capitalize,
    variant: status_variants[property.status] ?? 'neutral'
  }]) %}
{% endif %}
{% if property.listing_status and listing_badges[property.listing_status] %}
  {% set badges = badges|merge([listing_badges[property.listing_status]]) %}
{% endif %}

{# Build meta information #}
{% set meta = [] %}
{% if property.bedrooms %}
  {% set meta = meta|merge([{
    icon: 'bed',
    value: property.bedrooms ~ ' Bed'
  }]) %}
{% endif %}
{% if property.bathrooms %}
  {% set meta = meta|merge([{
    icon: 'bath',
    value: property.bathrooms ~ ' Bath'
  }]) %}
{% endif %}
{% if property.area %}
  {% set meta = meta|merge([{
    icon: 'area',
    value: property.area
  }]) %}
{% endif %}

{# Build actions #}
{% set actions = [] %}
{% if show_actions %}
  {% set actions = actions|merge([{
    label: 'View Details',
    variant: 'primary',
    href: property.permalink ?? '#'
  }]) %}
  {% if property.can_edit %}
    {% set actions = actions|merge([{
      label: 'Edit',
      variant: 'ghost',
      href: property.edit_link ?? '#'
    }]) %}
  {% endif %}
{% endif %}

{# Build footer content #}
{% set footer_content %}
  {% if show_owner and property.owner %}
    <div style="
      {%- include 'primitive-books/layout-book.twig' with {
        display: 'flex',
        align_items: 'center',
        justify_content: 'between'
      } -%}
    ">
      <span style="
        {%- include 'primitive-books/typography-book.twig' with {
          font_size: 'small',
          font_weight: 'medium'
        } -%}
        {%- include 'primitive-books/color-book.twig' with {
          color: 'base-dark'
        } -%}
      ">Owner: {{ property.owner }}</span>
      
      {% if property.price %}
        <span style="
          {%- include 'primitive-books/typography-book.twig' with {
            font_size: 'large',
            font_weight: 'bold'
          } -%}
          {%- include 'primitive-books/color-book.twig' with {
            color: 'primary'
          } -%}
        ">{{ property.price }}</span>
      {% endif %}
    </div>
  {% endif %}
{% endset %}

{# TEST BANNER TO VERIFY NEW COMPONENT SYSTEM #}
<div style="
  background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
  color: white;
  padding: 10px;
  text-align: center;
  font-weight: bold;
  margin-bottom: 10px;
  border-radius: 8px;
  animation: pulse 2s infinite;
">
  üéâ NEW COMPONENT SYSTEM ACTIVE! üéâ
</div>

<style>
  @keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.7; }
    100% { opacity: 1; }
  }
</style>

{# Render the property card using the base card component #}
{% include 'component-books/card-book.twig' with {
  variant: variant ?? 'default',
  title: 'üè† ' ~ property.title ~ ' (COMPONENT v2)',
  subtitle: property.address,
  image: property.image,
  badges: badges,
  meta: meta,
  actions: actions,
  footer: footer_content|trim ? footer_content : null,
  class: 'property-card ' ~ (class ?? ''),
  style: 'border: 3px solid #ff6b6b !important;'
} %}