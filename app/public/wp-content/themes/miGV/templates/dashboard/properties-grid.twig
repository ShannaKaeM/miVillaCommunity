{#
  Properties Grid View
  
  Displays user properties in a responsive grid layout using composable components
#}

<div class="dashboard-section properties-section">
    {# Component Version Indicator #}
    <div style="
        position: fixed;
        top: 20px;
        right: 20px;
        {%- include 'primitive-books/color-book.twig' with {
            background_color: 'primary',
            color: 'extreme-light'
        } -%}
        {%- include 'primitive-books/spacing-book.twig' with {
            padding_x: 'lg',
            padding_y: 'md'
        } -%}
        {%- include 'primitive-books/border-book.twig' with {
            border_radius: 'full'
        } -%}
        {%- include 'primitive-books/shadow-book.twig' with {
            box_shadow: 'lg'
        } -%}
        z-index: 1000;
        font-weight: 600;
    ">
        üöÄ Component Dashboard v2.0
    </div>
    {# Section Header #}
    <div class="section-header" style="
        {%- include 'primitive-books/layout-book.twig' with {
            display: 'flex',
            justify_content: 'between',
            align_items: 'center'
        } -%}
        {%- include 'primitive-books/spacing-book.twig' with {
            margin_bottom: 'xl'
        } -%}
    ">
        <h2 style="
            {%- include 'primitive-books/typography-book.twig' with {
                font_family: 'playfair-display',
                font_size: 'xx-large',
                font_weight: 'semiBold'
            } -%}
            {%- include 'primitive-books/color-book.twig' with {
                color: 'base-darkest'
            } -%}
        ">My Properties</h2>
        
        <div class="section-actions" style="
            {%- include 'primitive-books/layout-book.twig' with {
                display: 'flex',
                gap: 'md'
            } -%}
        ">
            {# View Toggle #}
            <div class="view-toggle" style="
                {%- include 'primitive-books/layout-book.twig' with {
                    display: 'flex',
                    gap: 'xs'
                } -%}
            ">
                <a href="?tab=properties&view=grid" class="view-option {{ view_mode == 'grid' ? 'active' : '' }}" style="
                    {%- include 'primitive-books/spacing-book.twig' with {
                        padding: 'sm'
                    } -%}
                    {%- include 'primitive-books/color-book.twig' with {
                        color: view_mode == 'grid' ? 'primary' : 'base'
                    } -%}
                ">Grid</a>
                <a href="?tab=properties&view=list" class="view-option {{ view_mode == 'list' ? 'active' : '' }}" style="
                    {%- include 'primitive-books/spacing-book.twig' with {
                        padding: 'sm'
                    } -%}
                    {%- include 'primitive-books/color-book.twig' with {
                        color: view_mode == 'list' ? 'primary' : 'base'
                    } -%}
                ">List</a>
            </div>
        </div>
    </div>
    
    {# Statistics Cards #}
    {% if stats %}
        <div class="property-stats" style="
            {%- include 'primitive-books/spacing-book.twig' with {
                margin_bottom: 'xl'
            } -%}
        ">
            {% include 'component-books/grid-book.twig' with {
                variant: 'stats',
                columns: {sm: 1, md: 3},
                items: [
                    {
                        value: stats.available,
                        label: 'Available',
                        color: 'success',
                        icon: 'check'
                    },
                    {
                        value: stats.occupied,
                        label: 'Occupied',
                        color: 'primary',
                        icon: 'home'
                    },
                    {
                        value: stats.maintenance,
                        label: 'Maintenance',
                        color: 'warning',
                        icon: 'tools'
                    }
                ],
                item_component: 'component-books/stat-card-book.twig'
            } %}
        </div>
    {% endif %}
    
    {# Filters #}
    <div class="property-filters" style="
        {%- include 'primitive-books/layout-book.twig' with {
            display: 'flex',
            gap: 'md',
            flex_wrap: 'wrap'
        } -%}
        {%- include 'primitive-books/spacing-book.twig' with {
            margin_bottom: 'lg'
        } -%}
    ">
        {% for status_key, status_label in filters.available_statuses %}
            <a href="?tab=properties&status={{ status_key }}" 
               class="filter-option {{ filters.status == status_key ? 'active' : '' }}"
               style="
                {%- include 'primitive-books/spacing-book.twig' with {
                    padding_x: 'lg',
                    padding_y: 'sm'
                } -%}
                {%- include 'primitive-books/border-book.twig' with {
                    border_width: 'thin',
                    border_style: 'solid',
                    border_color: filters.status == status_key ? 'primary' : 'base-light',
                    border_radius: 'full'
                } -%}
                {%- include 'primitive-books/color-book.twig' with {
                    color: filters.status == status_key ? 'primary' : 'base-dark',
                    background_color: filters.status == status_key ? 'primary-light' : 'transparent'
                } -%}
                {%- include 'primitive-books/animation-book.twig' with {
                    transition_property: 'all',
                    transition_duration: 'fast',
                    transition_timing: 'ease'
                } -%}
                text-decoration: none;
            ">{{ status_label }}</a>
        {% endfor %}
    </div>
    
    {# Properties Grid #}
    {% if properties|length > 0 %}
        {% include 'component-books/grid-book.twig' with {
            variant: 'cards',
            columns: {sm: 1, md: 2, lg: 3},
            items: properties|map(property => {
                'property': property,
                'show_owner': false,
                'show_actions': true
            }),
            item_component: 'component-books/property-card-book.twig',
            class: 'properties-grid'
        } %}
        
        {# Pagination #}
        {% if pagination.total_pages > 1 %}
            <div class="pagination" style="
                {%- include 'primitive-books/layout-book.twig' with {
                    display: 'flex',
                    justify_content: 'center',
                    gap: 'sm'
                } -%}
                {%- include 'primitive-books/spacing-book.twig' with {
                    margin_top: 'xl'
                } -%}
            ">
                {% if pagination.has_prev %}
                    <a href="?tab=properties&paged={{ pagination.prev_page }}" class="pagination-link">
                        {% include 'element-books/button-book.twig' with {
                            content: 'Previous',
                            variant: 'ghost',
                            size: 'sm'
                        } %}
                    </a>
                {% endif %}
                
                <span style="
                    {%- include 'primitive-books/layout-book.twig' with {
                        display: 'flex',
                        align_items: 'center'
                    } -%}
                    {%- include 'primitive-books/spacing-book.twig' with {
                        padding_x: 'md'
                    } -%}
                ">
                    Page {{ pagination.current_page }} of {{ pagination.total_pages }}
                </span>
                
                {% if pagination.has_next %}
                    <a href="?tab=properties&paged={{ pagination.next_page }}" class="pagination-link">
                        {% include 'element-books/button-book.twig' with {
                            content: 'Next',
                            variant: 'ghost',
                            size: 'sm'
                        } %}
                    </a>
                {% endif %}
            </div>
        {% endif %}
    {% else %}
        {# Empty State #}
        <div class="empty-state" style="
            {%- include 'primitive-books/layout-book.twig' with {
                display: 'flex',
                flex_direction: 'col',
                align_items: 'center',
                justify_content: 'center'
            } -%}
            {%- include 'primitive-books/spacing-book.twig' with {
                padding: '6xl'
            } -%}
            text-align: center;
        ">
            <div style="
                {%- include 'primitive-books/typography-book.twig' with {
                    font_size: 'huge'
                } -%}
                {%- include 'primitive-books/color-book.twig' with {
                    color: 'base-light'
                } -%}
                {%- include 'primitive-books/spacing-book.twig' with {
                    margin_bottom: 'lg'
                } -%}
            ">üè†</div>
            
            <h3 style="
                {%- include 'primitive-books/typography-book.twig' with {
                    font_size: 'x-large',
                    font_weight: 'medium'
                } -%}
                {%- include 'primitive-books/color-book.twig' with {
                    color: 'base-dark'
                } -%}
                {%- include 'primitive-books/spacing-book.twig' with {
                    margin_bottom: 'md'
                } -%}
            ">No properties found</h3>
            
            <p style="
                {%- include 'primitive-books/color-book.twig' with {
                    color: 'base'
                } -%}
            ">
                {% if filters.status != 'all' %}
                    No properties match the selected filter.
                    <a href="?tab=properties" style="color: var(--wp--preset--color--primary);">View all properties</a>
                {% else %}
                    You don't have any properties yet.
                {% endif %}
            </p>
        </div>
    {% endif %}
</div>